(this.webpackJsonpk_music=this.webpackJsonpk_music||[]).push([[7],{200:function(e,a,t){"use strict";var n=t(9),r=t(0),c=t.n(r),i=t(201),l=t.n(i);a.a=function(e){var a=Object(r.useState)(!1),t=Object(n.a)(a,2),i=t[0],s=t[1];return Object(r.useEffect)((function(){var a=new Image;a.src=e.src,a.onload=function(){s(!0)}}),[e.src]),c.a.createElement("img",{src:i?e.src:l.a,style:{width:e.width,height:e.height,border:e.border?"1px solid #f1f1f1":"none"},alt:""})}},201:function(e,a,t){e.exports=t.p+"static/media/default_image.3590e8c0.svg"},202:function(e,a,t){"use strict";var n=t(0),r=t.n(n),c=t(224),i=t(286);a.a=function(e){var a;return r.a.createElement("div",{style:{width:"100%",minHeight:"30vh",display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement(c.a,{tip:null!==(a=e.text)&&void 0!==a?a:"",indicator:r.a.createElement(i.a,{style:{fontSize:24}})}))}},270:function(e,a,t){e.exports={album:"_2hzivxDtZ7Lpvgv_X6pVe_",head:"_2G7dEGYEINlmoML5hs1NhP",logo:"_1XpWqywhwbUYPRNTj_2SwZ",img:"SjhxsrVLLEEskJ03LfpEl",main:"_1-lryxsU1rMvVjdxnaLMSB",name:"_1TgPIWbSRfEXB5K_PytIj-",creater:"_3ybRWFtnK1mBmZh1uYR2gJ",nickname:"_1jILlatWTSWRHiqXAiGlp6",createTime:"_1i2DNrQyAagf55L_oxgMSm",buttonGroup:"_2oNF_eCmWK3wXiMEX8ipq8",tags:"_2NXyU-l3NDvjYBWcqg7rAo",listBox:"_380ztTIKx73V2U9a6z6OTk",title:"_2R7Lx1geUI8ZuUW1MaR26i",list:"i7c1ccAuZx-PWGrwXZvan",item:"_1UK-h9FidD_9NTxhMCLDzD",index:"_3FrKiNJzzQaolrCA5-D_lD",song:"_1Mdfhs18QHPInAh85OfR1W",songName:"_2b0O4qR1U949NuqZHG0rDW",songCreator:"_2Ekk2V7bfLi-WIEHRrawnv",second:"_3HGrHnDeHpZumNXgIB0ahX",canPlaying:"_3B08xlREDZ2TTBjaHLS8na",backTop:"_2N80j-B5i-D0JuOeH9zKy8"}},284:function(e,a,t){"use strict";t.r(a);var n=t(49),r=t.n(n),c=t(70),i=t(9),l=t(0),s=t.n(l),m=t(285),o=t(194),u=t(281),d=t(282),f=t(287),b=t(288),v=t(8),g=t(114),E=t.n(g),p=t(69),h=t(37);var j=function(e){return-1!==e.st&&-200!==e.st&&1!==e.fee&&4!==e.fee&&16!==e.fee},N=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,t=e.length,n=[];if(t<=a)return[e];for(var r=0;r<t;r+=a)n.push(e.slice(r,r+a));return n},x=t(56),y=t(11),O=t(270),_=t.n(O),k=t(200),I=t(202),U={info:{albumId:"",name:"",nickname:"",coverImgUrl:"",createTime:0,avatarUrl:"",tags:[],description:""},list:[]};a.default=function(){var e=Object(v.b)(),a=Object(h.d)(),t=Object(l.useState)(!1),n=Object(i.a)(t,2),g=n[0],O=n[1],w=Object(l.useState)(!0),T=Object(i.a)(w,2),L=T[0],D=T[1],P=Object(h.b)("cache-song-list",null),q=Object(i.a)(P,2),z=q[0],C=q[1],S=Object(h.b)(a.query.id,U),W=Object(i.a)(S,2),H=W[0],M=W[1],R=Object(l.useMemo)((function(){return H.list.filter((function(e){return e.url}))}),[H.list]);Object(l.useEffect)((function(){z&&z.albumId===a.query.id&&z.list.length>0&&D(!1)}),[z,a.query.id]),Object(l.useEffect)((function(){function e(){return(e=Object(c.a)(r.a.mark((function e(){var t,n,c,i,l,s,m,o,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,Object(p.a)(a.query.id);case 3:return t=e.sent,n=t.data.playlist,c={info:{albumId:a.query.id,name:n.name,nickname:n.creator.nickname,avatarUrl:n.creator.avatarUrl,createTime:n.createTime,coverImgUrl:n.coverImgUrl,description:n.description,tags:n.tags},list:[]},i=N(n.trackIds.map((function(e){return e.id}))).map((function(e){return e.join(",")})),e.prev=7,l=i.map((function(e){return Object(p.e)(e)})),e.next=11,Promise.all(l);case 11:return s=e.sent,m=[],o=[],s.forEach((function(e){m=m.concat(e.data.songs),o=o.concat(e.data.privileges)})),c.list=m.map((function(e,a){return{id:e.id,name:e.name,seconds:e.dt/1e3,authors:e.ar.map((function(e){return e.name})).join("\uff0c"),coverImgUrl:e.al.picUrl,canPlaying:j(o[a]),url:null}})),u=c.list.map((function(e){return Object(p.g)(e.id)})),e.next=19,Promise.all(u);case 19:d=e.sent,c.list.map((function(e,a){return e.url=d[a].data.data[0].url})),M(c),C({list:c.list.filter((function(e){return e.url})),albumId:a.query.id});case 23:return e.prev=23,O(!1),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[7,,23,26]])})))).apply(this,arguments)}H&&H.list.length>0||function(){e.apply(this,arguments)}()}),[H,a.query.id,M,C]);var B=Object(l.useCallback)((function(){L&&e(Object(y.g)({data:R})),e(Object(y.c)({id:R[0].id,index:0,autoPlay:!1}))}),[R,e,L]),X=Object(l.useCallback)((function(){L&&e(Object(y.g)({data:R})),e(Object(y.c)({id:R[0].id,index:0,autoPlay:!0}))}),[L,R,e]),Z=Object(l.useCallback)((function(a){var t=R.findIndex((function(e){return e.id===a}));t<0&&e(Object(y.g)({data:R})),e(Object(y.c)({id:a,index:t,autoPlay:!0}))}),[R,e]);return console.log("album render"),s.a.createElement("div",{className:_.a.album},s.a.createElement("div",{className:_.a.head},s.a.createElement("div",{className:_.a.logo},s.a.createElement("img",{className:_.a.img,src:H.info.coverImgUrl,alt:""})),s.a.createElement("div",{className:_.a.main},s.a.createElement("div",{className:_.a.name},s.a.createElement(m.a,{color:"magenta"},"\u6b4c\u5355"),H.info.name),s.a.createElement("div",{className:_.a.creater},s.a.createElement(k.a,{width:"36px",height:"36px",src:H.info.avatarUrl,border:!0}),s.a.createElement("div",{className:_.a.nickname},H.info.nickname),s.a.createElement("div",{className:_.a.createTime},"\u521b\u5efa\u65f6\u95f4\uff1a",H.info.createTime?E()().format("YYYY-MM-DD"):"NULL")),s.a.createElement("div",{className:_.a.buttonGroup},s.a.createElement(o.a,{size:"small",icon:s.a.createElement(f.a,null),onClick:X},"\u64ad\u653e"),s.a.createElement(o.a,{size:"small",onClick:B},s.a.createElement(b.a,null))),s.a.createElement("div",{className:_.a.tags},"\u6807\u7b7e\uff1a",H.info.tags.map((function(e){return s.a.createElement(m.a,{key:e},e)}))),s.a.createElement("div",{className:_.a.descript},"\u4ecb\u7ecd\uff1a",H.info.description))),s.a.createElement("div",{className:_.a.listBox},s.a.createElement("div",{className:_.a.title},"\u6b4c\u66f2\u5217\u8868"),s.a.createElement("div",{className:_.a.list},g?s.a.createElement(I.a,{text:"Loading..."}):s.a.createElement(u.b,{bordered:!0,size:"small",dataSource:H.list,renderItem:function(e,a){return s.a.createElement(u.b.Item,{key:e.id},s.a.createElement("div",{className:_.a.item},s.a.createElement("div",{className:_.a.index},a+1),s.a.createElement("div",{className:_.a.song},s.a.createElement(k.a,{border:!0,src:e.coverImgUrl,width:"36px",height:"36px"}),s.a.createElement("div",{className:_.a.songName},e.name)),s.a.createElement("div",{className:_.a.songCreator},e.authors),s.a.createElement("div",{className:_.a.second},s.a.createElement(x.a,{seconds:e.seconds})),s.a.createElement("div",{className:_.a.canPlaying},e.url?s.a.createElement(o.a,{onClick:function(){return Z(e.id)},type:"text",size:"small"},"\u64ad\u653e"):s.a.createElement(o.a,{type:"text",size:"small",disabled:!0},"\u65e0\u7248\u6743"))))}}))),s.a.createElement(d.a,{className:_.a.backTop,visibilityHeight:600}))}}}]);
//# sourceMappingURL=7.5ac4722f.chunk.js.map